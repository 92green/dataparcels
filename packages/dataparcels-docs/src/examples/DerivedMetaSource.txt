import React from 'react';
import useParcelState from 'react-dataparcels/useParcelState';
import ParcelBoundary from 'react-dataparcels/ParcelBoundary';
import asShape from 'react-dataparcels/asShape';

const setWordLengthMeta = asShape(parcelShape => parcelShape.setMeta({
    wordLength: parcelShape.value.word.length
}));

export default function WordEditor(props) {

    let [wordParcel] = useParcelState({
        value: {
            word: "blueberries",
            wordLength: undefined
        },
        beforeChange: setWordLengthMeta
    });

    return <div>
        <label>word</label>
        <ParcelBoundary parcel={wordParcel.get('word')}>
            {(parcel) => <input type="text" {...parcel.spreadDOM()} />}
        </ParcelBoundary>
        <p>word length is {wordParcel.meta.wordLength}</p>
    </div>;
}
